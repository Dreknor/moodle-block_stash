define(["core/templates","block_stash/dialogue-base","core/ajax"],function(a,b,c){function d(a,c,d){this._trade=a,this._warnings=c,this._altSnippetMaker=d,this.setTitle(a.get("name")),b.prototype.constructor.apply(this,[])}return d.prototype=Object.create(b.prototype),d.prototype.constructor=d,d.prototype._trade=null,d.prototype._warnings=null,d.prototype._render=function(){var b={trade:this._trade.getData(),tradejson:JSON.stringify(this._trade.getData()),warnings:this._warnings,haswarnings:this._warnings&&this._warnings.length,altsnippetmaker:this._altSnippetMaker};return c.call([{methodname:"block_stash_get_trade_items",args:{tradeid:this._trade.get("id")}}])[0].then(function(c){b.tradeitems=c,a.render("block_stash/trade_snippet_dialogue",b).then(function(b,c){this._setDialogueContent(b),this.center(),a.runTemplateJS(c)}.bind(this))}.bind(this))},d});