define(["jquery","core/templates","core/yui"],function(a,b,c){function d(b){var d=a.Deferred();this._ready=d.promise(),this._drop=b,c.use("moodle-core-notification",function(){this._init().then(function(){d.resolve()})}.bind(this))}return d.prototype._dialogue=null,d.prototype._drop=null,d.prototype._maker=null,d.prototype._ready=null,d.prototype._altSnippetMaker=null,d.prototype._ui=null,d.prototype._warnings=null,d.prototype._init=function(){var d,e=a.Deferred(),f=c.Node.create('<p style="text-align: center;"><img src="'+M.util.image_url("y/loading")+'" alt=""></p>');d=new M.core.dialogue({draggable:!0,modal:!0,width:"600px"}),this._dialogue=d;var g=d.hide;return d.hide=function(){g.apply(d,arguments),this.destroy()}.bind(d),d.getStdModNode(c.WidgetStdMod.HEADER).prepend(c.Node.create("<h1>"+this._drop.get("name")+"</h1>")),d.setStdModContent(c.WidgetStdMod.BODY,f,c.WidgetStdMod.REPLACE),e.resolve(),this._render().then(function(a,e){b.runTemplateJS(e),d.setStdModContent(c.WidgetStdMod.BODY,a,c.WidgetStdMod.REPLACE),d.centerDialogue()}),e},d.prototype.find=function(a){return this._container.find(a)},d.prototype._render=function(){var a={drop:this._drop.getData(),dropjson:JSON.stringify(this._drop.getData()),item:this._drop.getItem().getData(),itemjson:JSON.stringify(this._drop.getItem().getData()),altsnippetmaker:this._altSnippetMaker,warnings:this._warnings,haswarnings:this._warnings&&this._warnings.length};return b.render("block_stash/drop_snippet_dialogue",a)},d.prototype.setAlternateSnippetMaker=function(a){this._altSnippetMaker=a},d.prototype.setWarnings=function(a){this._warnings=a},d.prototype.show=function(a){this._ready.then(function(){this._dialogue.show(a)}.bind(this))},d});